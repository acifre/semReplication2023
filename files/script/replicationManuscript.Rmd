---
title             : "SEM Replication: Indirect effect of sleep on abdominal pain through daytime dysfunction in adults with irritable bowel syndrome"
shorttitle        : "SEM Replication"

author: 
  - name          : "Anthony Cifre"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author


affiliation:
  - id            : "1"
    institution   : "University of Houston"




abstract: |
  The study aimed to examine the potential indirect effects of sleep on abdominal pain symptoms simultaneously through psychological distress and daytime dysfunction in adults with irritable bowel syndrome (IBS). Daily symptoms of sleep, psychological distress, daytime dysfunction, and abdominal pain were collected from 332 adults with IBS. The study found that poor sleep had a strong indirect effect on abdominal pain via daytime dysfunction but not psychological distress. These findings suggest that optimizing personalized and hybrid behavioral interventions for adults with IBS should focus on addressing daytime dysfunction and sleep behaviors. Further studies integrating symptoms with biological markers are needed to explore the underlying mechanisms accounting for these symptoms.
  I will attempt to replicate the study findings...
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "irritable bowel syndrome, sleep, pain, daytime dysfunction, psychological distress"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : no
linenumbers       : no
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}

# Load Required Packages
if (!require("pacman")) install.packages("pacman")
pacman::p_load("tidyverse", "lavaan", "papaja")

#options(scipen=0) # yes scientific notation
#options(scipen=999) # no scientific notation
r_refs("r-references.bib")
```

This project focuses on irritable bowel syndrome (IBS), a chronic functional bowel disorder that affects a significant proportion of the population worldwide. IBS is characterized by abdominal pain or discomfort related to defecation or changes in bowel habits. Individuals with IBS experience gastrointestinal symptoms like abdominal pain, constipation or diarrhea, abdominal bloating, as well as nongastrointestinal symptoms, such as sleep deficiency, psychological distress, and daytime dysfunction. Sleep deficiency is a well-known issue that affects approximately 37.6% of the population with IBS.

Poor sleep quality is a crucial modifiable risk factor for IBS symptom flare-ups, particularly abdominal pain. However, little is known about the roles of psychological distress and daytime dysfunction in the sleep-pain relationship in adults with IBS. Previous studies have suggested the indirect effect of sleep on pain through psychological distress; nonetheless, no studies have evaluated the indirect effect of sleep on pain through both psychological distress and daytime dysfunction. The purpose of this study is to examine the potential indirect effects of sleep on pain through psychological distress and/or daytime dysfunction using a structural equation modeling (SEM) approach among adults with IBS. SEM allows for the inclusion of multiple indicators and analyses of multiple relationships simultaneously.


# Methods

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

### Creating Sample-Covariance Matrix

```{r data-preparation, echo=TRUE, tidy=T}
# Declare vector with names of variables 
full_names <- c("Abdominal pain", "Abdominal pain after eating", 
           "Abdominal distention", "Intestinal gas", 
           "Diminished sleep quality", "Unrefreshed sleep", "Fatigue", 
           "Sleepiness during the day", "Hard to concentrate", "Anxiety", 
           "Stress", "Depressive mood")

names <- c("ab_pain", "ab_pain_after_eat", 
           "ab_dist", "intest_gas", 
           "dim_sleep_qual", "unrefresh_sleep", "fatigue", 
           "sleepiness_day", "hard_concent", "anxiety", 
           "stress", "dep_mood")

# Import correlation matrix 
cor_matrix <- as.matrix(read_csv("../../files/data/cor_matrix.csv", col_names = FALSE))

# Create vector with standard deviations for each variable 
sds <- c(26.05, 26.01, 31.82, 
         30.05, 27.18, 27.15, 
         27.25, 25.79, 20.77, 
         22.41, 25.44, 16.51)

# Convert correlation matrix to covariance matrix using standard deviations
cov_matrix <- cor2cov(cor_matrix, sds = sds, names = names)

write.csv(cov_matrix, "../../files/data/cov_matrix.csv")
```

### Model Specification

#### Measurement Model

```{r model-specification, echo=TRUE}

measurement_model <- '
  # Latent variables ||  Y1 is measured by X1 + X2 + X3
  
    abdominal_discomfort =~ ab_pain + ab_pain_after_eat + ab_dist + intest_gas
    nightime_sleep =~ dim_sleep_qual + unrefresh_sleep
    day_dysfunction =~ fatigue + sleepiness_day + hard_concent
    psych_distress =~ anxiety + stress + dep_mood
    
    
  # Covariances
    
    abdominal_discomfort ~~ nightime_sleep
    abdominal_discomfort ~~ day_dysfunction
    abdominal_discomfort ~~ psych_distress
    nightime_sleep ~~ day_dysfunction
    nightime_sleep ~~ psych_distress
    day_dysfunction ~~ psych_distress
    

    
'

fit <- sem(measurement_model, 
           sample.cov = cov_matrix, 
           sample.nobs = 332)
summary(fit, standardized = TRUE)

# 
#   # Regressions || Y1 regressed on X1 
#   
#     psych_distress ~ nightime_sleep
#     day_dysfunction ~ nightime_sleep + psych_distress
#     abdominal_discomfort ~ day_dysfunction + nightime_sleep + psych_distress



```

```{r, include=TRUE}
int_structural_model <- '   
  # Latent variables ||  Y1 is measured by X1 + X2 + X3
  
    abdominal_discomfort =~ ab_pain + ab_pain_after_eat + ab_dist + intest_gas
    nightime_sleep =~ dim_sleep_qual + unrefresh_sleep
    day_dysfunction =~ fatigue + sleepiness_day + hard_concent
    psych_distress =~ anxiety + stress + dep_mood
  
  # mediation
  ## outcome model 
  abdominal_discomfort  ~ c*nightime_sleep + b1*psych_distress + b2*day_dysfunction
  
  ## mediator models
  psych_distress ~ a1*nightime_sleep
  day_dysfunction ~ a2*nightime_sleep
  
  ## indirect effects (IDE)
  psych_distress_IDE  := a1*b1
  day_dysfunction_IDE  := a2*b2
  sumIDE := (a1*b1) + (a2*b2)
  
  ## total effect
  total := c + (a1*b1) + (a2*b2)
  psych_distress ~~ day_dysfunction # model correlation between mediators
'
# 
# model <- '
# # outcome model 
# abdominal_discomfort  ~ c*nightime_sleep + b1*psych_distress + b2*day_dysfunction
# 
# # mediator models
# psych_distress ~ a1*nightime_sleep
# day_dysfunction ~ a2*nightime_sleep
# 
# # indirect effects (IDE)
# psych_distress_IDE  := a1*b1
# day_dysfunction_IDE  := a2*b2
# sumIDE := (a1*b1) + (a2*b2)
# 
# # total effect
# total := c + (a1*b1) + (a2*b2)
# psych_distress ~~ day_dysfunction # model correlation between mediators
# '

initial_fit <- sem(int_structural_model, 
           sample.cov = cov_matrix, 
           sample.nobs = 332)
summary(initial_fit, fit.measures = TRUE, standardized = TRUE, rsquare = TRUE)


```




I used `r cite_r("r-references.bib")` for all analyses.


# Results

# Discussion


\newpage

# References

::: {#refs custom-style="Bibliography"}
:::
